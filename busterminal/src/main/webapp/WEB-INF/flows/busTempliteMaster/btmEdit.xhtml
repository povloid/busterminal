
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pk="http://java.sun.com/jsf/composite/pkomponents"
	xmlns:bt="http://java.sun.com/jsf/composite/busterminal">

<ui:composition template="/WEB-INF/templites/templite.xhtml">
	<ui:define name="title">
		Редактирование шаблона
	</ui:define>

	<ui:define name="header_icon">
		<h:graphicImage value="/images/icons/wiz_32.png" />
	</ui:define>

	<ui:define name="header">
		Редактирование шаблона
	</ui:define>

	<ui:define name="content">
		<h:form>
			<p:messages showDetail="true" autoUpdate="true" />

			<pk:pk_close_button action="end" />

			<pk:pkdialog_crud_buttons add_action="#{btmWFControl.confirmAdd}"
				edit_action_and_close="#{btmWFControl.confirmEditAndClose}"
				edit_action="#{btmWFControl.confirmEdit}"
				del_action="#{btmWFControl.confirmDel}" add_view="#{false}"
				edit_view="#{true}" del_view="#{false}" />

			<br />
			<br />

			<p:fieldset
				legend="Автобус: #{btmWFControl.edited.keyName} - #{btmWFControl.edited.gosNum}"
				toggleable="true" toggleSpeed="500" collapsed="true">
				<h:panelGrid id="detail" columns="2">

					<h:outputText value="№:" />
					<h:outputText value="#{btmWFControl.edited.id}" />

					<h:outputLabel value="KeyName:" />
					<h:outputText value="#{btmWFControl.edited.keyName}" />

					<h:outputLabel value="gosNum:" />
					<h:outputText value="#{btmWFControl.edited.gosNum}" />

					<h:outputLabel value="Description:" />
					<h:outputText value="#{btmWFControl.edited.description}" />

				</h:panelGrid>
			</p:fieldset>

			<h:panelGrid columns="3" style="margin-bottom:10px" cellpadding="5">

				<h:outputText value="Схема: " />
				<p:selectOneButton value="#{btmWFControl.selectedSchemeId}">
					<f:selectItems value="#{btmWFControl.edited.schemas}" var="row"
						itemLabel="#{row.keyName}" itemValue="#{row.id}" />
					<p:ajax event="change" update="@form"
						listener="#{btmWFControl.handleSchemaChange}" />
				</p:selectOneButton>

				<h:panelGroup rendered="#{btmWFControl.selectedScheme != null}">
					<h:outputText
						value="#{btmWFControl.selectedScheme.keyName} - #{btmWFControl.selectedScheme.xSize}x#{btmWFControl.selectedScheme.ySize}" />

					<pk:pk_edit_button_wf
						edit_action="#{btmWFControl.editSelectedSchema}" />
				</h:panelGroup>

			</h:panelGrid>

			<p:separator />


			<h:panelGroup
				rendered="#{btmWFControl.selectedScheme.xSize gt 0 and btmWFControl.selectedScheme.ySize gt 0}">
				<table border="1">
					<ui:repeat var="y" value="#{btmWFControl.cells}">
						<tr>
							<ui:repeat var="x" value="#{y}">
								<td><bt:cell cell="#{x}"
										selectedCell="#{btmWFControl.selectedCell}"
										add_to_cell_action="#{btmWFControl.addToCell}" /></td>
							</ui:repeat>
						</tr>
					</ui:repeat>
				</table>
			</h:panelGroup>





		</h:form>
	</ui:define>
	<ui:define name="footer">

	</ui:define>
</ui:composition>
</html>
